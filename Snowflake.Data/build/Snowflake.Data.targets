<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- Copy native library only for .NET Framework on Windows -->
  <ItemGroup Condition="$([MSBuild]::IsOSPlatform('Windows')) And ('$(TargetFrameworkIdentifier)' == '.NETFramework' Or '$(TargetFramework)' == 'netstandard2.0')">
    <NativeLibrary Include="$(MSBuildThisFileDirectory)..\runtimes\win-x64\native\sf_mini_core.dll" Condition="'$(PROCESSOR_ARCHITECTURE)' != 'ARM64'" />
    <NativeLibrary Include="$(MSBuildThisFileDirectory)..\runtimes\win-arm64\native\sf_mini_core.dll" Condition="'$(PROCESSOR_ARCHITECTURE)' == 'ARM64'" />
  </ItemGroup>

  <Target Name="CopyMiniCoreNativeLibraries" AfterTargets="Build">
    <Copy SourceFiles="@(NativeLibrary)" DestinationFolder="$(OutputPath)" SkipUnchangedFiles="true" Condition="'@(NativeLibrary)' != ''" />
    <Message Importance="High" Text="CopyMiniCoreNativeLibraries: Copied @(NativeLibrary) to $(OutputPath)" Condition="'@(NativeLibrary)' != ''" />
  </Target>
</Project>
