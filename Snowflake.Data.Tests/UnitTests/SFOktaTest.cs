using NUnit.Framework;
using Snowflake.Data.Client;
using Snowflake.Data.Core;
using System.Threading;
using System.Threading.Tasks;
using Snowflake.Data.Core.Session;

namespace Snowflake.Data.Tests.UnitTests
{
    [TestFixture]
    class SFOktaTest
    {
        const string WrongPostbackContent = " < !DOCTYPE html >< html lang =\"en\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/><meta name=\"robots\" content=\"noarchive\"/><meta name=\"googlebot\" content=\"noarchive\"/><meta name=\"robots\" content=\"noindex\" />\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge\" />\n<meta name=\"apple-mobile-web-app-capable\" content=\"yes\"><meta name=\"googlebot\" content=\"noindex\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta name=\"robots\" content=\"none\" />\n\n<link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-16x16.c55b69ae49b08edc7c000d12b8e5483f.png\" rel=\"icon\" type=\"image/png\" sizes=\"16x16\"/><link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-32x32.99bc356b6e293b927f9e3a2b69761c26.png\" rel=\"icon\" type=\"image/png\" sizes=\"32x32\"/><link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-96x96.de98828614fa33ca04fcfaa07679f345.png\" rel=\"icon\" type=\"image/png\" sizes=\"96x96\"/><meta name=\"msapplication-TileColor\" content=\"#ffffff\">\n<meta name=\"msapplication-TileImage\" content=\"/img/icons/favicons/ms-icon-144x144.png\">\n<meta name=\"application-name\" content=\"Okta\"/>\n<meta name=\"theme-color\" content=\"#ffffff\">\n<meta name=\"msapplication-config\" content=\"/img/icons/favicons/browserconfig.xml\"/>\n\n<title>Snowflake - Signing in...</title>\n<!--[if IE]><link href=\"https://ok3static.oktacdn.com/assets/css/ie/ie.57ba8b295e567530b9a1b92e266a6eae.css\" type=\"text/css\" rel=\"stylesheet\"/><![endif]-->\n<!--[if gte IE 9]><link href=\"https://ok3static.oktacdn.com/assets/css/ie/ie9.0d563c6ff0555c4086c6606c3e6387e5.css\" type=\"text/css\" rel=\"stylesheet\"/><![endif]-->\n\n<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>\n\n<script>\n    var okta = {\n        migrateMute: true,\n        locale: 'en',\n        debug: false,\n        deployEnv: 'PROD',\n        userId: '00u141kzp5sTIufWw1d8',\n        settings: {\n            orgId: '00oy3jwwiqWBAGOLOWLT',\n            orgName: 'Snowflake',\n            serverStatus: 'ACTIVE',\n            persona: '',\n            isDeveloperConsole: '' === 'true',\n            isPreview: 'false' === 'true',\n            permissions: []\n        },\n        logHasFeatureError: function(message) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('POST', '/api/internal/client-logging/has-feature-error', true);\n            xhr.setRequestHeader('Content-Type', 'application/json');\n            xhr.send(JSON.stringify({\n              message: message\n            }));\n        }\n\n    };\n</script>\n<script>var _features=[\"MONTHLY_FLAG_2019_01\",\"MONTHLY_FLAG_2018_12\",\"DEV_APPS\",\"MONTHLY_FLAG_2019_04\",\"MONTHLY_FLAG_2018_10\",\"MONTHLY_FLAG_2018_09\",\"MONTHLY_FLAG_2019_05\",\"APP_NOTES\",\"MONTHLY_FLAG_2019_02\",\"MONTHLY_FLAG_2018_11\",\"API_ACCESS_MANAGEMENT\",\"MONTHLY_FLAG_2019_03\"];</script><script>\n      window._features = window._features || [];\n      _features.push('DEV_CONSOLE');\n    </script>\n<script>window.okta || (window.okta = {}); okta.cdnUrlHostname = \"//ok3static.oktacdn.com\"; okta.cdnPerformCheck = false;</script><script>window.okta || (window.okta = {});window.okta.mixpanel = true;window.okta.mixpanelTrackingSamplingFactors = {\"_DEFAULT\":1.0};</script><script src=\"https://ok3static.oktacdn.com/assets/js/jquery-1.12.4.min.e93c5a2265fbe2a3e96fe19159fc9a84.js\" crossorigin=\"anonymous\" integrity=\"sha384-KA5uVfsh/aGN4nZ9iqQ+CAYy0emdYEnjgFsPzqxBi2AMeqLX5qoCiY4ICzIg61TX\" type=\"text/javascript\"></script><!--[if lt IE 9]><script src=\"https://ok3static.oktacdn.com/assets/enduser/js/vendor/css3-mediaqueries.fa295f0132f5335f352071ca3613a94a.js\" crossorigin=\"anonymous\" integrity=\"sha384-7pU2GSgyec3nzQMUNSuzanfJelP9UCOyHil0bOv+WnPKSS9lNA/tcxPyr7NV2w6c\" type=\"text/javascript\"></script><![endif]-->\n\n<script>if (window.module) module = window.module;</script>\n\n</head>\n<body id=\"app\" class=\"enduser-app  \">\n<noscript><div id=\"noscript-mask\"></div><div id=\"noscript-msg\" class=\"infobox infobox-warning infobox-compact\"><span class=\"icon warning-16\"></span><h3>Javascript is disabled on your browser.</h3><p>Please enable Javascript and refresh this page to use Okta.</p></div></noscript>\n\n<div id=\"container\">\n<link href=\"https://ok3static.oktacdn.com/assets/css/sections/interstitial.8c2f4a8544ec4c72abb54659e8a83b0e.css\" type=\"text/css\" rel=\"stylesheet\"/><script>\n    var interstitialMinWaitTime = 1200;\n    </script>\n<!--[if lte IE 9]>\n            <style type=\"text/css\">\n                #okta-auth-spin {\n                    top: 35%;\n                }\n            </style>\n        <![endif]-->\n\n        <!--[if lte IE 8]>\n            <style type=\"text/css\">\n                #okta-auth-band {\n                    height: 200px;\n                }\n            </style>\n        <![endif]-->\n\n        <div id=\"okta-interstitial-wrap\">\n                <div class=\"okta-auth-mask-new-interstitial\"></div>\n        <div class=\"new-interstitial\" id=\"new-interstitial\">\n        <div id=\"okta-auth-band\">\n            <img src=\"https://ok3static.oktacdn.com/assets/img/ui/indicators/new_interstitial_static.9481d4731547cec09b26be142dbeec61.png\" width=\"376\" height=\"160\" alt=\"Please wait\" class=\"new-img-static\"/><img src=\"https://ok3static.oktacdn.com/assets/img/ui/indicators/new_interstitial.c41c3b6f3a84458aca9a5919f238fbe3.gif\" width=\"376\" height=\"160\" alt=\"Please wait\" class=\"new-img\"/><img src=\"https://ok3static.oktacdn.com/assets/img/logos/okta_watermark.4a7f2ccf7d0a787cff6f59fb67f72843.png\" width=\"106\" height=\"36\" alt=\"Okta\" class=\"okta-logo\"/><div id=\"okta-auth-spin\"></div>\n                    <div id=\"okta-auth-spin-small\"></div>\n                <h1 id=\"okta-auth-heading\" class ='signing-in-text'>Signing in to TESTACCOUNT (regression)</h1>\n        </div>\n        </div> <!--new-interstitial -->\n        </div> <!--okta-interstitial-wrap -->\n\n        <script type=\"text/javascript\">\n            $(function(){\n                var isFFSVGFixEnabled = 'false';\n                if ($('#okta-auth-spin').hasClass('android-spinner')) {\n                    return;\n                }\n\n                // Remove gif animation for Safari\n                var isSafari = /AppleWebKit/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor);\n                if (isFFSVGFixEnabled && isSafari) {\n                    $('.new-img').hide(0);\n                } else {\n                    $('.new-img').on('load', function(evt){\n                        //gif loaded correctly, fade out static asset and fade in gif\n                        //making sure we show the graphic before the form submit happens in 200ms\n                        $('.new-img-static').hide(0,function(){\n                            $('.new-img').show(0);\n                        });\n                    });\n                }\n\n                //For cached images with src the load event fires just before you add a listener for it. Hence setting the source again to make sure the event handlers fire in the right order.\n                var assetUrl = $('.new-img').attr('src');\n                $('.new-img').attr('src', assetUrl);\n\n                var standard = document.getElementById('okta-auth-spin');\n                var small = document.getElementById('okta-auth-spin-small');\n\n                var optsStandard = {\n                    lines: 9, // The number of lines to draw\n                    length: 0, // The length of each line\n                    width: 8, // The line thickness\n                    radius: 21, // The radius of the inner circle\n                    corners: 1, // Corner roundness (0..1)\n                    rotate: 0, // The rotation offset\n                    direction: 1, // 1: clockwise, -1: counterclockwise\n                    color: '#fff', // #rgb or #rrggbb\n                    speed: 1, // Rounds per second\n                    trail: 60, // Afterglow percentage\n                    shadow: false, // Whether to render a shadow\n                    hwaccel: false, // Whether to use hardware acceleration\n                    className: 'okta-auth-spinner', // The CSS class to assign to the spinner\n                    zIndex: 2e9, // The z-index (defaults to 2000000000)\n                    top: 'auto', // Top position relative to parent in px\n                    left: 'auto' // Left position relative to parent in px\n                };\n\n                var optsSmall = {\n                    lines: 9, // The number of lines to draw\n                    length: 0, // The length of each line\n                    width: 6, // The line thickness\n                    radius: 14, // The radius of the inner circle\n                    corners: 1, // Corner roundness (0..1)\n                    rotate: 0, // The rotation offset\n                    direction: 1, // 1: clockwise, -1: counterclockwise\n                    color: '#fff', // #rgb or #rrggbb\n                    speed: 1, // Rounds per second\n                    trail: 60, // Afterglow percentage\n                    shadow: false, // Whether to render a shadow\n                    hwaccel: false, // Whether to use hardware acceleration\n                    className: 'okta-auth-spinner', // The CSS class to assign to the spinner\n                    zIndex: 2e9, // The z-index (defaults to 2000000000)\n                    top: 'auto', // Top position relative to parent in px\n                    left: 'auto' // Left position relative to parent in px\n                };\n                if (typeof Spinner === 'function') {\n                    var spinnerStandard = new Spinner(optsStandard);\n                    var spinnerSmall = new Spinner(optsSmall);\n\n                    spinnerStandard.spin(standard);\n                    spinnerSmall.spin(small);\n                }\n\n            });\n        </script>\n    <form id=\"appForm\" action=\"http&#x3a;&#x2f;&#x2f;testaccount.dev.snowflakecomputing.com&#x3a;8082&#x2f;fed&#x2f;login\" method=\"POST\">\n    <input name=\"SAMLResponse\" type=\"hidden\" value=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbDJwOlJlc3BvbnNlIHhtbG5zOnNhbWwycD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIiBEZXN0aW5hdGlvbj0iaHR0cDovL3Rlc3RhY2NvdW50LnNub3dmbGFrZWNvbXB1dGluZy5jb206ODA4Mi9mZWQvbG9naW4iIElEPSJpZDM2OTI3Nzc0NDA0Njg3NDIxODk5NjI5MTcwIiBJc3N1ZUluc3RhbnQ9IjIwMTktMDUtMjhUMjE6MzQ6MTkuMzI2WiIgVmVyc2lvbj0iMi4wIj48c2FtbDI6SXNzdWVyIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSI&#x2b;aHR0cDovL3d3dy5va3RhLmNvbS9leGsxYTU1aWtwelcxVlBWcjFkODwvc2FtbDI6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8&#x2b;PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIFVSST0iI2lkMzY5Mjc3NzQ0MDQ2ODc0MjE4OTk2MjkxNzAiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybXM&#x2b;PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5hUDYvbUhGMFFKTUdkWlJSNlVYZ2o0QW9HaW5WMnF3VHBRVytEVzVHcnJFPTwvZHM6RGlnZXN0VmFsdWU&#x2b;PC9kczpSZWZlcmVuY2U&#x2b;PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZT5KNlYrYVFMaTRTVGR3NXFmWEU3czRrVS9ycHRDaWYvM0liUnRWaWc4K2Y1SldMWDdiaVlqZExueWlhRHpObGRVYXJzeGQzRDd5eHkzUWNyZ2hCRlp3ZGVlbFR5b3krWmZFSzltd3NnTm9wMTFKTktneHRsNTRnNmhiSUlOaXVVOEhxOExUNUs2SXAzZE5ZN1E1WFV2U09rTVUwZUg5M3ZDMExVaWVYZDJBektqSUtaa3lZNmlDdi9BSis5SUNvQk9FMHBTZnl2RjNiZjRWRmhWQkwvSVBFMFg1eTBIZzFERmNZWXhqaVhrYXU2cmN2NjBDcEZ6ejdxaFJCOTJyWDEyMm0zRHlaR3ZVVHJEalVsRXd0Mk0yazhyNy8zWjlURWc2VE9wc3ovMmNEME1xTHBNOWJtenpkZWQ4MzZoUC83WlJiUG5UNGM0OHAvakRCMXNieTMyS1E9PTwvZHM6U2lnbmF0dXJlVmFsdWU&#x2b;PGRzOktleUluZm8&#x2b;PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlmaWNhdGU&#x2b;TUlJRHREQ0NBcHlnQXdJQkFnSUdBVmhLZEhkc01BMEdDU3FHU0liM0RRRUJDd1VBTUlHYU1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFRwpBMVVFQ0F3S1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ3d05VMkZ1SUVaeVlXNWphWE5qYnpFTk1Bc0dBMVVFQ2d3RVQydDBZVEVVCk1CSUdBMVVFQ3d3TFUxTlBVSEp2ZG1sa1pYSXhHekFaQmdOVkJBTU1Fbk51YjNkbWJHRnJaV052YlhCMWRHbHVaekVjTUJvR0NTcUcKU0liM0RRRUpBUllOYVc1bWIwQnZhM1JoTG1OdmJUQWVGdzB4TmpFeE1Ea3hPRFUzTVRaYUZ3MHlOakV4TURreE9EVTRNVFphTUlHYQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0F3S1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ3d05VMkZ1SUVaeVlXNWphWE5qCmJ6RU5NQXNHQTFVRUNnd0VUMnQwWVRFVU1CSUdBMVVFQ3d3TFUxTlBVSEp2ZG1sa1pYSXhHekFaQmdOVkJBTU1Fbk51YjNkbWJHRnIKWldOdmJYQjFkR2x1WnpFY01Cb0dDU3FHU0liM0RRRUpBUllOYVc1bWIwQnZhM1JoTG1OdmJUQ0NBU0l3RFFZSktvWklodmNOQVFFQgpCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMY1VadDZEMVh0ck1Mc08rakp4cS95R29LV1JBbXRTeU9kSVhITEVkMWppSFNuUkxOdEM5VldaClNHVTVZcTliSDlrR0x3NDZrVWZXcXlGb05rM2VQOVVQRlY2NUZ3emtrU24rNDhYMkl4WXBHUjcwSnJjYlBBS3l6VlR4M1U5NXkrZ0MKaUlkSjdsWUFNNWxCaUY5UTgxVjE5RzA2cHpsbzBSVlpPQ09sbHZCU2RrUnJiQXhlRGNTN2tSRElxUGh6SHdIM1hWOWpmLzRjZVhmUQpCUXZjKzIxWEZnTzRXTmtrWUxlemllYzQzNkd2aittRmRLVHhiTktpQmdxbnQ5VUZmM3hxdG01ajlyTDdHQ0VtNmVnL0dhdW84VFZNCng3c21GSVBkZVNrUmRFVytxU2tPbjlHdzhZZHNEY2UzRTRjVXlnY3o1WjZMakFRbGNVYVNaVTlqZlpNQ0F3RUFBVEFOQmdrcWhraUcKOXcwQkFRc0ZBQU9DQVFFQVdURmowVXkwQ0xGbThYdzh3dlhjQlA3aU5vMjFIcS9rbStJL0UzbnVKMDlPcmlFamMwRGJyZ0ZvN3ZqSQpxSUU4YWEyM2J3eUlBbEZZQzZ3NlF6TFpIeG9EbnpLU1FRSEM5NXVEYW9XcXVvWTdYb3UvSjlvQjJtQy8vL0l5ME1OOHljWCs1YnRuClM2cWRWVnVXaE9HMEMrOXg4UGIydW1DNlFUcXBTZ3E0U01nV0VOellFUnZaRDgzTTFsZzY5aElZaVRqZ2tCMU1FQXZWbUs0N0M2UlgKQXZzMld1T0Vkc1V3M1g4T0FSLzh4TWlpamt3ZzByeU93TGxONzRHZGphTEVnWU5PM0tqdjNiOEh3UlJKMXdkekxZV0tBaXFXb1R3aQpXcGNZcytlbVlPcVZSNTJzR1NGYnQrbmEzVStFZXRtVStPa0J1TjhIcXJYVFY5ekFmZTE3SGc9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE&#x2b;PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMnA6U3RhdHVzIHhtbG5zOnNhbWwycD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIj48c2FtbDJwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbDJwOlN0YXR1cz48c2FtbDI6QXNzZXJ0aW9uIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBJRD0iaWQzNjkyNzc3NDQwNTUxMTYwMTQ1MDQ4NjgyOSIgSXNzdWVJbnN0YW50PSIyMDE5LTA1LTI4VDIxOjM0OjE5LjMyNloiIFZlcnNpb249IjIuMCI&#x2b;PHNhbWwyOklzc3VlciBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPmh0dHA6Ly93d3cub2t0YS5jb20vZXhrMWE1NWlrcHpXMVZQVnIxZDg8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8&#x2b;PGRzOlJlZmVyZW5jZSBVUkk9IiNpZDM2OTI3Nzc0NDA1NTExNjAxNDUwNDg2ODI5Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8&#x2b;PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiLz48ZHM6RGlnZXN0VmFsdWU&#x2b;VUQ0SHNVNzRCbGFSNjcxTnJBaFVvNWJqYlpEemJwTnp0SVpza2lJMGRkTT08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlPjwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWU&#x2b;aVA0emZWQVJsdTVaM0gya3B4V0hYeVNpZzZabERKdXdvd0FobW95Wmg3VmxPK0txaGdvYXBrTGxxNW1FTTdhTXg3V3VodjBRM0luNjlaYjl6UGJqaWpsYWQzWW4vTTRDVGVveFZBV0dUN1VtMDhJdnBsc2NEK1RKSks1WG9BRWZVcGp3MVlzczgycEJhVlgwbVp1citla1Y1MEhvUUhsb1FUTUpDeHJ4aXB0aXBSSmhlblR5QVBQelVDQ3R5K1crenNKaWZTdnRLNWFEcmEvSnlRMFJyRWNlakdKRjlrbFlFUnVwNGE1QlpMSmlKQ1JLWXZzOCtYWlhjakVMV1RIWUpHMjUvZXRBVVgvQ3drU3h6WlYzckU4ZjVMbU9iTTJGTTg5bjE5aHJTc0tmUWFhdkU3WDBEeURJTU5GNHpoZndFcTVUZTJaWXdRMnczRHZHazBBekxRPT08L2RzOlNpZ25hdHVyZVZhbHVlPjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUR0RENDQXB5Z0F3SUJBZ0lHQVZoS2RIZHNNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1JR2FNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUcKQTFVRUNBd0tRMkZzYVdadmNtNXBZVEVXTUJRR0ExVUVCd3dOVTJGdUlFWnlZVzVqYVhOamJ6RU5NQXNHQTFVRUNnd0VUMnQwWVRFVQpNQklHQTFVRUN3d0xVMU5QVUhKdmRtbGtaWEl4R3pBWkJnTlZCQU1NRW5OdWIzZG1iR0ZyWldOdmJYQjFkR2x1WnpFY01Cb0dDU3FHClNJYjNEUUVKQVJZTmFXNW1iMEJ2YTNSaExtTnZiVEFlRncweE5qRXhNRGt4T0RVM01UWmFGdzB5TmpFeE1Ea3hPRFU0TVRaYU1JR2EKTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNBd0tRMkZzYVdadmNtNXBZVEVXTUJRR0ExVUVCd3dOVTJGdUlFWnlZVzVqYVhOagpiekVOTUFzR0ExVUVDZ3dFVDJ0MFlURVVNQklHQTFVRUN3d0xVMU5QVUhKdmRtbGtaWEl4R3pBWkJnTlZCQU1NRW5OdWIzZG1iR0ZyClpXTnZiWEIxZEdsdVp6RWNNQm9HQ1NxR1NJYjNEUUVKQVJZTmFXNW1iMEJ2YTNSaExtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUIKQlFBRGdnRVBBRENDQVFvQ2dnRUJBTGNVWnQ2RDFYdHJNTHNPK2pKeHEveUdvS1dSQW10U3lPZElYSExFZDFqaUhTblJMTnRDOVZXWgpTR1U1WXE5Ykg5a0dMdzQ2a1VmV3F5Rm9OazNlUDlVUEZWNjVGd3pra1NuKzQ4WDJJeFlwR1I3MEpyY2JQQUt5elZUeDNVOTV5K2dDCmlJZEo3bFlBTTVsQmlGOVE4MVYxOUcwNnB6bG8wUlZaT0NPbGx2QlNka1JyYkF4ZURjUzdrUkRJcVBoekh3SDNYVjlqZi80Y2VYZlEKQlF2YysyMVhGZ080V05ra1lMZXppZWM0MzZHdmorbUZkS1R4Yk5LaUJncW50OVVGZjN4cXRtNWo5ckw3R0NFbTZlZy9HYXVvOFRWTQp4N3NtRklQZGVTa1JkRVcrcVNrT245R3c4WWRzRGNlM0U0Y1V5Z2N6NVo2TGpBUWxjVWFTWlU5amZaTUNBd0VBQVRBTkJna3Foa2lHCjl3MEJBUXNGQUFPQ0FRRUFXVEZqMFV5MENMRm04WHc4d3ZYY0JQN2lObzIxSHEva20rSS9FM251SjA5T3JpRWpjMERicmdGbzd2akkKcUlFOGFhMjNid3lJQWxGWUM2dzZRekxaSHhvRG56S1NRUUhDOTV1RGFvV3F1b1k3WG91L0o5b0IybUMvLy9JeTBNTjh5Y1grNWJ0bgpTNnFkVlZ1V2hPRzBDKzl4OFBiMnVtQzZRVHFwU2dxNFNNZ1dFTnpZRVJ2WkQ4M00xbGc2OWhJWWlUamdrQjFNRUF2Vm1LNDdDNlJYCkF2czJXdU9FZHNVdzNYOE9BUi84eE1paWprd2cwcnlPd0xsTjc0R2RqYUxFZ1lOTzNLanYzYjhId1JSSjF3ZHpMWVdLQWlxV29Ud2kKV3BjWXMrZW1ZT3FWUjUyc0dTRmJ0K25hM1UrRWV0bVUrT2tCdU44SHFyWFRWOXpBZmUxN0hnPT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L2RzOlNpZ25hdHVyZT48c2FtbDI6U3ViamVjdCB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI&#x2b;PHNhbWwyOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIj5xYUBzbm93Zmxha2Vjb21wdXRpbmcuY29tPC9zYW1sMjpOYW1lSUQ&#x2b;PHNhbWwyOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48c2FtbDI6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgTm90T25PckFmdGVyPSIyMDE5LTA1LTI4VDIxOjM5OjE5LjMyNloiIFJlY2lwaWVudD0iaHR0cDovL3Rlc3RhY2NvdW50LnNub3dmbGFrZWNvbXB1dGluZy5jb206ODA4Mi9mZWQvbG9naW4iLz48L3NhbWwyOlN1YmplY3RDb25maXJtYXRpb24&#x2b;PC9zYW1sMjpTdWJqZWN0PjxzYW1sMjpDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAxOS0wNS0yOFQyMToyOToxOS4zMjZaIiBOb3RPbk9yQWZ0ZXI9IjIwMTktMDUtMjhUMjE6Mzk6MTkuMzI2WiIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjxzYW1sMjpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sMjpBdWRpZW5jZT5odHRwOi8vdGVzdGFjY291bnQuc25vd2ZsYWtlY29tcHV0aW5nLmNvbTo4MDgyL2ZlZC9sb2dpbjwvc2FtbDI6QXVkaWVuY2U&#x2b;PC9zYW1sMjpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvc2FtbDI6Q29uZGl0aW9ucz48c2FtbDI6QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDE5LTA1LTI4VDIxOjM0OjE5LjMyNloiIFNlc3Npb25JbmRleD0iaWQxNTU5MDc5MjU5MzI2LjQ0NjkwMzY4OCIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjxzYW1sMjpBdXRobkNvbnRleHQ&#x2b;PHNhbWwyOkF1dGhuQ29udGV4dENsYXNzUmVmPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphYzpjbGFzc2VzOlBhc3N3b3JkUHJvdGVjdGVkVHJhbnNwb3J0PC9zYW1sMjpBdXRobkNvbnRleHRDbGFzc1JlZj48L3NhbWwyOkF1dGhuQ29udGV4dD48L3NhbWwyOkF1dGhuU3RhdGVtZW50Pjwvc2FtbDI6QXNzZXJ0aW9uPjwvc2FtbDJwOlJlc3BvbnNlPg&#x3d;&#x3d;\"/>\n    <input name=\"RelayState\" type=\"hidden\" value=\"&#x2f;some&#x2f;deep&#x2f;link\"/>\n</form>\n\n<script src=\"https://ok3static.oktacdn.com/assets/js/app/sso/interstitial.474dce61acfac4a4d016921943cf2a68.js\" crossorigin=\"anonymous\" integrity=\"sha384-rIRjIHrr5XnyB1DG8t+uL1F3e5asM+gYMial0fj56hCWADEBdp3BiwtOAnNpU7Zc\" type=\"text/javascript\"></script></div>\n<!-- close #container -->\n</body>\n</html>\n";
        const string NoPostbackContent = " < !DOCTYPE html >< html lang =\"en\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/><meta name=\"robots\" content=\"noarchive\"/><meta name=\"googlebot\" content=\"noarchive\"/><meta name=\"robots\" content=\"noindex\" />\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge\" />\n<meta name=\"apple-mobile-web-app-capable\" content=\"yes\"><meta name=\"googlebot\" content=\"noindex\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta name=\"robots\" content=\"none\" />\n\n<link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-16x16.c55b69ae49b08edc7c000d12b8e5483f.png\" rel=\"icon\" type=\"image/png\" sizes=\"16x16\"/><link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-32x32.99bc356b6e293b927f9e3a2b69761c26.png\" rel=\"icon\" type=\"image/png\" sizes=\"32x32\"/><link href=\"https://ok3static.oktacdn.com/assets/img/icons/favicons/favicon-96x96.de98828614fa33ca04fcfaa07679f345.png\" rel=\"icon\" type=\"image/png\" sizes=\"96x96\"/><meta name=\"msapplication-TileColor\" content=\"#ffffff\">\n<meta name=\"msapplication-TileImage\" content=\"/img/icons/favicons/ms-icon-144x144.png\">\n<meta name=\"application-name\" content=\"Okta\"/>\n<meta name=\"theme-color\" content=\"#ffffff\">\n<meta name=\"msapplication-config\" content=\"/img/icons/favicons/browserconfig.xml\"/>\n\n<title>Snowflake - Signing in...</title>\n<!--[if IE]><link href=\"https://ok3static.oktacdn.com/assets/css/ie/ie.57ba8b295e567530b9a1b92e266a6eae.css\" type=\"text/css\" rel=\"stylesheet\"/><![endif]-->\n<!--[if gte IE 9]><link href=\"https://ok3static.oktacdn.com/assets/css/ie/ie9.0d563c6ff0555c4086c6606c3e6387e5.css\" type=\"text/css\" rel=\"stylesheet\"/><![endif]-->\n\n<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>\n\n<script>\n    var okta = {\n        migrateMute: true,\n        locale: 'en',\n        debug: false,\n        deployEnv: 'PROD',\n        userId: '00u141kzp5sTIufWw1d8',\n        settings: {\n            orgId: '00oy3jwwiqWBAGOLOWLT',\n            orgName: 'Snowflake',\n            serverStatus: 'ACTIVE',\n            persona: '',\n            isDeveloperConsole: '' === 'true',\n            isPreview: 'false' === 'true',\n            permissions: []\n        },\n        logHasFeatureError: function(message) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('POST', '/api/internal/client-logging/has-feature-error', true);\n            xhr.setRequestHeader('Content-Type', 'application/json');\n            xhr.send(JSON.stringify({\n              message: message\n            }));\n        }\n\n    };\n</script>\n<script>var _features=[\"MONTHLY_FLAG_2019_01\",\"MONTHLY_FLAG_2018_12\",\"DEV_APPS\",\"MONTHLY_FLAG_2019_04\",\"MONTHLY_FLAG_2018_10\",\"MONTHLY_FLAG_2018_09\",\"MONTHLY_FLAG_2019_05\",\"APP_NOTES\",\"MONTHLY_FLAG_2019_02\",\"MONTHLY_FLAG_2018_11\",\"API_ACCESS_MANAGEMENT\",\"MONTHLY_FLAG_2019_03\"];</script><script>\n      window._features = window._features || [];\n      _features.push('DEV_CONSOLE');\n    </script>\n<script>window.okta || (window.okta = {}); okta.cdnUrlHostname = \"//ok3static.oktacdn.com\"; okta.cdnPerformCheck = false;</script><script>window.okta || (window.okta = {});window.okta.mixpanel = true;window.okta.mixpanelTrackingSamplingFactors = {\"_DEFAULT\":1.0};</script><script src=\"https://ok3static.oktacdn.com/assets/js/jquery-1.12.4.min.e93c5a2265fbe2a3e96fe19159fc9a84.js\" crossorigin=\"anonymous\" integrity=\"sha384-KA5uVfsh/aGN4nZ9iqQ+CAYy0emdYEnjgFsPzqxBi2AMeqLX5qoCiY4ICzIg61TX\" type=\"text/javascript\"></script><!--[if lt IE 9]><script src=\"https://ok3static.oktacdn.com/assets/enduser/js/vendor/css3-mediaqueries.fa295f0132f5335f352071ca3613a94a.js\" crossorigin=\"anonymous\" integrity=\"sha384-7pU2GSgyec3nzQMUNSuzanfJelP9UCOyHil0bOv+WnPKSS9lNA/tcxPyr7NV2w6c\" type=\"text/javascript\"></script><![endif]-->\n\n<script>if (window.module) module = window.module;</script>\n\n</head>\n<body id=\"app\" class=\"enduser-app  \">\n<noscript><div id=\"noscript-mask\"></div><div id=\"noscript-msg\" class=\"infobox infobox-warning infobox-compact\"><span class=\"icon warning-16\"></span><h3>Javascript is disabled on your browser.</h3><p>Please enable Javascript and refresh this page to use Okta.</p></div></noscript>\n\n<div id=\"container\">\n<link href=\"https://ok3static.oktacdn.com/assets/css/sections/interstitial.8c2f4a8544ec4c72abb54659e8a83b0e.css\" type=\"text/css\" rel=\"stylesheet\"/><script>\n    var interstitialMinWaitTime = 1200;\n    </script>\n<!--[if lte IE 9]>\n            <style type=\"text/css\">\n                #okta-auth-spin {\n                    top: 35%;\n                }\n            </style>\n        <![endif]-->\n\n        <!--[if lte IE 8]>\n            <style type=\"text/css\">\n                #okta-auth-band {\n                    height: 200px;\n                }\n            </style>\n        <![endif]-->\n\n        <div id=\"okta-interstitial-wrap\">\n                <div class=\"okta-auth-mask-new-interstitial\"></div>\n        <div class=\"new-interstitial\" id=\"new-interstitial\">\n        <div id=\"okta-auth-band\">\n            <img src=\"https://ok3static.oktacdn.com/assets/img/ui/indicators/new_interstitial_static.9481d4731547cec09b26be142dbeec61.png\" width=\"376\" height=\"160\" alt=\"Please wait\" class=\"new-img-static\"/><img src=\"https://ok3static.oktacdn.com/assets/img/ui/indicators/new_interstitial.c41c3b6f3a84458aca9a5919f238fbe3.gif\" width=\"376\" height=\"160\" alt=\"Please wait\" class=\"new-img\"/><img src=\"https://ok3static.oktacdn.com/assets/img/logos/okta_watermark.4a7f2ccf7d0a787cff6f59fb67f72843.png\" width=\"106\" height=\"36\" alt=\"Okta\" class=\"okta-logo\"/><div id=\"okta-auth-spin\"></div>\n                    <div id=\"okta-auth-spin-small\"></div>\n                <h1 id=\"okta-auth-heading\" class ='signing-in-text'>Signing in to TESTACCOUNT (regression)</h1>\n        </div>\n        </div> <!--new-interstitial -->\n        </div> <!--okta-interstitial-wrap -->\n\n        <script type=\"text/javascript\">\n            $(function(){\n                var isFFSVGFixEnabled = 'false';\n                if ($('#okta-auth-spin').hasClass('android-spinner')) {\n                    return;\n                }\n\n                // Remove gif animation for Safari\n                var isSafari = /AppleWebKit/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor);\n                if (isFFSVGFixEnabled && isSafari) {\n                    $('.new-img').hide(0);\n                } else {\n                    $('.new-img').on('load', function(evt){\n                        //gif loaded correctly, fade out static asset and fade in gif\n                        //making sure we show the graphic before the form submit happens in 200ms\n                        $('.new-img-static').hide(0,function(){\n                            $('.new-img').show(0);\n                        });\n                    });\n                }\n\n                //For cached images with src the load event fires just before you add a listener for it. Hence setting the source again to make sure the event handlers fire in the right order.\n                var assetUrl = $('.new-img').attr('src');\n                $('.new-img').attr('src', assetUrl);\n\n                var standard = document.getElementById('okta-auth-spin');\n                var small = document.getElementById('okta-auth-spin-small');\n\n                var optsStandard = {\n                    lines: 9, // The number of lines to draw\n                    length: 0, // The length of each line\n                    width: 8, // The line thickness\n                    radius: 21, // The radius of the inner circle\n                    corners: 1, // Corner roundness (0..1)\n                    rotate: 0, // The rotation offset\n                    direction: 1, // 1: clockwise, -1: counterclockwise\n                    color: '#fff', // #rgb or #rrggbb\n                    speed: 1, // Rounds per second\n                    trail: 60, // Afterglow percentage\n                    shadow: false, // Whether to render a shadow\n                    hwaccel: false, // Whether to use hardware acceleration\n                    className: 'okta-auth-spinner', // The CSS class to assign to the spinner\n                    zIndex: 2e9, // The z-index (defaults to 2000000000)\n                    top: 'auto', // Top position relative to parent in px\n                    left: 'auto' // Left position relative to parent in px\n                };\n\n                var optsSmall = {\n                    lines: 9, // The number of lines to draw\n                    length: 0, // The length of each line\n                    width: 6, // The line thickness\n                    radius: 14, // The radius of the inner circle\n                    corners: 1, // Corner roundness (0..1)\n                    rotate: 0, // The rotation offset\n                    direction: 1, // 1: clockwise, -1: counterclockwise\n                    color: '#fff', // #rgb or #rrggbb\n                    speed: 1, // Rounds per second\n                    trail: 60, // Afterglow percentage\n                    shadow: false, // Whether to render a shadow\n                    hwaccel: false, // Whether to use hardware acceleration\n                    className: 'okta-auth-spinner', // The CSS class to assign to the spinner\n                    zIndex: 2e9, // The z-index (defaults to 2000000000)\n                    top: 'auto', // Top position relative to parent in px\n                    left: 'auto' // Left position relative to parent in px\n                };\n                if (typeof Spinner === 'function') {\n                    var spinnerStandard = new Spinner(optsStandard);\n                    var spinnerSmall = new Spinner(optsSmall);\n\n                    spinnerStandard.spin(standard);\n                    spinnerSmall.spin(small);\n                }\n\n            });\n        </script>\n    <form id=\"appForm\" method=\"POST\">\n    <input name=\"SAMLResponse\" type=\"hidden\" value=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbDJwOlJlc3BvbnNlIHhtbG5zOnNhbWwycD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIiBEZXN0aW5hdGlvbj0iaHR0cDovL3Rlc3RhY2NvdW50LnNub3dmbGFrZWNvbXB1dGluZy5jb206ODA4Mi9mZWQvbG9naW4iIElEPSJpZDM2OTI3Nzc0NDA0Njg3NDIxODk5NjI5MTcwIiBJc3N1ZUluc3RhbnQ9IjIwMTktMDUtMjhUMjE6MzQ6MTkuMzI2WiIgVmVyc2lvbj0iMi4wIj48c2FtbDI6SXNzdWVyIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSI&#x2b;aHR0cDovL3d3dy5va3RhLmNvbS9leGsxYTU1aWtwelcxVlBWcjFkODwvc2FtbDI6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8&#x2b;PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIFVSST0iI2lkMzY5Mjc3NzQ0MDQ2ODc0MjE4OTk2MjkxNzAiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybXM&#x2b;PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5hUDYvbUhGMFFKTUdkWlJSNlVYZ2o0QW9HaW5WMnF3VHBRVytEVzVHcnJFPTwvZHM6RGlnZXN0VmFsdWU&#x2b;PC9kczpSZWZlcmVuY2U&#x2b;PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZT5KNlYrYVFMaTRTVGR3NXFmWEU3czRrVS9ycHRDaWYvM0liUnRWaWc4K2Y1SldMWDdiaVlqZExueWlhRHpObGRVYXJzeGQzRDd5eHkzUWNyZ2hCRlp3ZGVlbFR5b3krWmZFSzltd3NnTm9wMTFKTktneHRsNTRnNmhiSUlOaXVVOEhxOExUNUs2SXAzZE5ZN1E1WFV2U09rTVUwZUg5M3ZDMExVaWVYZDJBektqSUtaa3lZNmlDdi9BSis5SUNvQk9FMHBTZnl2RjNiZjRWRmhWQkwvSVBFMFg1eTBIZzFERmNZWXhqaVhrYXU2cmN2NjBDcEZ6ejdxaFJCOTJyWDEyMm0zRHlaR3ZVVHJEalVsRXd0Mk0yazhyNy8zWjlURWc2VE9wc3ovMmNEME1xTHBNOWJtenpkZWQ4MzZoUC83WlJiUG5UNGM0OHAvakRCMXNieTMyS1E9PTwvZHM6U2lnbmF0dXJlVmFsdWU&#x2b;PGRzOktleUluZm8&#x2b;PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlmaWNhdGU&#x2b;TUlJRHREQ0NBcHlnQXdJQkFnSUdBVmhLZEhkc01BMEdDU3FHU0liM0RRRUJDd1VBTUlHYU1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFRwpBMVVFQ0F3S1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ3d05VMkZ1SUVaeVlXNWphWE5qYnpFTk1Bc0dBMVVFQ2d3RVQydDBZVEVVCk1CSUdBMVVFQ3d3TFUxTlBVSEp2ZG1sa1pYSXhHekFaQmdOVkJBTU1Fbk51YjNkbWJHRnJaV052YlhCMWRHbHVaekVjTUJvR0NTcUcKU0liM0RRRUpBUllOYVc1bWIwQnZhM1JoTG1OdmJUQWVGdzB4TmpFeE1Ea3hPRFUzTVRaYUZ3MHlOakV4TURreE9EVTRNVFphTUlHYQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0F3S1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ3d05VMkZ1SUVaeVlXNWphWE5qCmJ6RU5NQXNHQTFVRUNnd0VUMnQwWVRFVU1CSUdBMVVFQ3d3TFUxTlBVSEp2ZG1sa1pYSXhHekFaQmdOVkJBTU1Fbk51YjNkbWJHRnIKWldOdmJYQjFkR2x1WnpFY01Cb0dDU3FHU0liM0RRRUpBUllOYVc1bWIwQnZhM1JoTG1OdmJUQ0NBU0l3RFFZSktvWklodmNOQVFFQgpCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMY1VadDZEMVh0ck1Mc08rakp4cS95R29LV1JBbXRTeU9kSVhITEVkMWppSFNuUkxOdEM5VldaClNHVTVZcTliSDlrR0x3NDZrVWZXcXlGb05rM2VQOVVQRlY2NUZ3emtrU24rNDhYMkl4WXBHUjcwSnJjYlBBS3l6VlR4M1U5NXkrZ0MKaUlkSjdsWUFNNWxCaUY5UTgxVjE5RzA2cHpsbzBSVlpPQ09sbHZCU2RrUnJiQXhlRGNTN2tSRElxUGh6SHdIM1hWOWpmLzRjZVhmUQpCUXZjKzIxWEZnTzRXTmtrWUxlemllYzQzNkd2aittRmRLVHhiTktpQmdxbnQ5VUZmM3hxdG01ajlyTDdHQ0VtNmVnL0dhdW84VFZNCng3c21GSVBkZVNrUmRFVytxU2tPbjlHdzhZZHNEY2UzRTRjVXlnY3o1WjZMakFRbGNVYVNaVTlqZlpNQ0F3RUFBVEFOQmdrcWhraUcKOXcwQkFRc0ZBQU9DQVFFQVdURmowVXkwQ0xGbThYdzh3dlhjQlA3aU5vMjFIcS9rbStJL0UzbnVKMDlPcmlFamMwRGJyZ0ZvN3ZqSQpxSUU4YWEyM2J3eUlBbEZZQzZ3NlF6TFpIeG9EbnpLU1FRSEM5NXVEYW9XcXVvWTdYb3UvSjlvQjJtQy8vL0l5ME1OOHljWCs1YnRuClM2cWRWVnVXaE9HMEMrOXg4UGIydW1DNlFUcXBTZ3E0U01nV0VOellFUnZaRDgzTTFsZzY5aElZaVRqZ2tCMU1FQXZWbUs0N0M2UlgKQXZzMld1T0Vkc1V3M1g4T0FSLzh4TWlpamt3ZzByeU93TGxONzRHZGphTEVnWU5PM0tqdjNiOEh3UlJKMXdkekxZV0tBaXFXb1R3aQpXcGNZcytlbVlPcVZSNTJzR1NGYnQrbmEzVStFZXRtVStPa0J1TjhIcXJYVFY5ekFmZTE3SGc9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE&#x2b;PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMnA6U3RhdHVzIHhtbG5zOnNhbWwycD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIj48c2FtbDJwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbDJwOlN0YXR1cz48c2FtbDI6QXNzZXJ0aW9uIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBJRD0iaWQzNjkyNzc3NDQwNTUxMTYwMTQ1MDQ4NjgyOSIgSXNzdWVJbnN0YW50PSIyMDE5LTA1LTI4VDIxOjM0OjE5LjMyNloiIFZlcnNpb249IjIuMCI&#x2b;PHNhbWwyOklzc3VlciBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpuYW1laWQtZm9ybWF0OmVudGl0eSIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPmh0dHA6Ly93d3cub2t0YS5jb20vZXhrMWE1NWlrcHpXMVZQVnIxZDg8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8&#x2b;PGRzOlJlZmVyZW5jZSBVUkk9IiNpZDM2OTI3Nzc0NDA1NTExNjAxNDUwNDg2ODI5Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8&#x2b;PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiLz48ZHM6RGlnZXN0VmFsdWU&#x2b;VUQ0SHNVNzRCbGFSNjcxTnJBaFVvNWJqYlpEemJwTnp0SVpza2lJMGRkTT08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlPjwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWU&#x2b;aVA0emZWQVJsdTVaM0gya3B4V0hYeVNpZzZabERKdXdvd0FobW95Wmg3VmxPK0txaGdvYXBrTGxxNW1FTTdhTXg3V3VodjBRM0luNjlaYjl6UGJqaWpsYWQzWW4vTTRDVGVveFZBV0dUN1VtMDhJdnBsc2NEK1RKSks1WG9BRWZVcGp3MVlzczgycEJhVlgwbVp1citla1Y1MEhvUUhsb1FUTUpDeHJ4aXB0aXBSSmhlblR5QVBQelVDQ3R5K1crenNKaWZTdnRLNWFEcmEvSnlRMFJyRWNlakdKRjlrbFlFUnVwNGE1QlpMSmlKQ1JLWXZzOCtYWlhjakVMV1RIWUpHMjUvZXRBVVgvQ3drU3h6WlYzckU4ZjVMbU9iTTJGTTg5bjE5aHJTc0tmUWFhdkU3WDBEeURJTU5GNHpoZndFcTVUZTJaWXdRMnczRHZHazBBekxRPT08L2RzOlNpZ25hdHVyZVZhbHVlPjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUR0RENDQXB5Z0F3SUJBZ0lHQVZoS2RIZHNNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1JR2FNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUcKQTFVRUNBd0tRMkZzYVdadmNtNXBZVEVXTUJRR0ExVUVCd3dOVTJGdUlFWnlZVzVqYVhOamJ6RU5NQXNHQTFVRUNnd0VUMnQwWVRFVQpNQklHQTFVRUN3d0xVMU5QVUhKdmRtbGtaWEl4R3pBWkJnTlZCQU1NRW5OdWIzZG1iR0ZyWldOdmJYQjFkR2x1WnpFY01Cb0dDU3FHClNJYjNEUUVKQVJZTmFXNW1iMEJ2YTNSaExtTnZiVEFlRncweE5qRXhNRGt4T0RVM01UWmFGdzB5TmpFeE1Ea3hPRFU0TVRaYU1JR2EKTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNBd0tRMkZzYVdadmNtNXBZVEVXTUJRR0ExVUVCd3dOVTJGdUlFWnlZVzVqYVhOagpiekVOTUFzR0ExVUVDZ3dFVDJ0MFlURVVNQklHQTFVRUN3d0xVMU5QVUhKdmRtbGtaWEl4R3pBWkJnTlZCQU1NRW5OdWIzZG1iR0ZyClpXTnZiWEIxZEdsdVp6RWNNQm9HQ1NxR1NJYjNEUUVKQVJZTmFXNW1iMEJ2YTNSaExtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUIKQlFBRGdnRVBBRENDQVFvQ2dnRUJBTGNVWnQ2RDFYdHJNTHNPK2pKeHEveUdvS1dSQW10U3lPZElYSExFZDFqaUhTblJMTnRDOVZXWgpTR1U1WXE5Ykg5a0dMdzQ2a1VmV3F5Rm9OazNlUDlVUEZWNjVGd3pra1NuKzQ4WDJJeFlwR1I3MEpyY2JQQUt5elZUeDNVOTV5K2dDCmlJZEo3bFlBTTVsQmlGOVE4MVYxOUcwNnB6bG8wUlZaT0NPbGx2QlNka1JyYkF4ZURjUzdrUkRJcVBoekh3SDNYVjlqZi80Y2VYZlEKQlF2YysyMVhGZ080V05ra1lMZXppZWM0MzZHdmorbUZkS1R4Yk5LaUJncW50OVVGZjN4cXRtNWo5ckw3R0NFbTZlZy9HYXVvOFRWTQp4N3NtRklQZGVTa1JkRVcrcVNrT245R3c4WWRzRGNlM0U0Y1V5Z2N6NVo2TGpBUWxjVWFTWlU5amZaTUNBd0VBQVRBTkJna3Foa2lHCjl3MEJBUXNGQUFPQ0FRRUFXVEZqMFV5MENMRm04WHc4d3ZYY0JQN2lObzIxSHEva20rSS9FM251SjA5T3JpRWpjMERicmdGbzd2akkKcUlFOGFhMjNid3lJQWxGWUM2dzZRekxaSHhvRG56S1NRUUhDOTV1RGFvV3F1b1k3WG91L0o5b0IybUMvLy9JeTBNTjh5Y1grNWJ0bgpTNnFkVlZ1V2hPRzBDKzl4OFBiMnVtQzZRVHFwU2dxNFNNZ1dFTnpZRVJ2WkQ4M00xbGc2OWhJWWlUamdrQjFNRUF2Vm1LNDdDNlJYCkF2czJXdU9FZHNVdzNYOE9BUi84eE1paWprd2cwcnlPd0xsTjc0R2RqYUxFZ1lOTzNLanYzYjhId1JSSjF3ZHpMWVdLQWlxV29Ud2kKV3BjWXMrZW1ZT3FWUjUyc0dTRmJ0K25hM1UrRWV0bVUrT2tCdU44SHFyWFRWOXpBZmUxN0hnPT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L2RzOlNpZ25hdHVyZT48c2FtbDI6U3ViamVjdCB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI&#x2b;PHNhbWwyOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIj5xYUBzbm93Zmxha2Vjb21wdXRpbmcuY29tPC9zYW1sMjpOYW1lSUQ&#x2b;PHNhbWwyOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48c2FtbDI6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgTm90T25PckFmdGVyPSIyMDE5LTA1LTI4VDIxOjM5OjE5LjMyNloiIFJlY2lwaWVudD0iaHR0cDovL3Rlc3RhY2NvdW50LnNub3dmbGFrZWNvbXB1dGluZy5jb206ODA4Mi9mZWQvbG9naW4iLz48L3NhbWwyOlN1YmplY3RDb25maXJtYXRpb24&#x2b;PC9zYW1sMjpTdWJqZWN0PjxzYW1sMjpDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAxOS0wNS0yOFQyMToyOToxOS4zMjZaIiBOb3RPbk9yQWZ0ZXI9IjIwMTktMDUtMjhUMjE6Mzk6MTkuMzI2WiIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjxzYW1sMjpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sMjpBdWRpZW5jZT5odHRwOi8vdGVzdGFjY291bnQuc25vd2ZsYWtlY29tcHV0aW5nLmNvbTo4MDgyL2ZlZC9sb2dpbjwvc2FtbDI6QXVkaWVuY2U&#x2b;PC9zYW1sMjpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvc2FtbDI6Q29uZGl0aW9ucz48c2FtbDI6QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDE5LTA1LTI4VDIxOjM0OjE5LjMyNloiIFNlc3Npb25JbmRleD0iaWQxNTU5MDc5MjU5MzI2LjQ0NjkwMzY4OCIgeG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjxzYW1sMjpBdXRobkNvbnRleHQ&#x2b;PHNhbWwyOkF1dGhuQ29udGV4dENsYXNzUmVmPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphYzpjbGFzc2VzOlBhc3N3b3JkUHJvdGVjdGVkVHJhbnNwb3J0PC9zYW1sMjpBdXRobkNvbnRleHRDbGFzc1JlZj48L3NhbWwyOkF1dGhuQ29udGV4dD48L3NhbWwyOkF1dGhuU3RhdGVtZW50Pjwvc2FtbDI6QXNzZXJ0aW9uPjwvc2FtbDJwOlJlc3BvbnNlPg&#x3d;&#x3d;\"/>\n    <input name=\"RelayState\" type=\"hidden\" value=\"&#x2f;some&#x2f;deep&#x2f;link\"/>\n</form>\n\n<script src=\"https://ok3static.oktacdn.com/assets/js/app/sso/interstitial.474dce61acfac4a4d016921943cf2a68.js\" crossorigin=\"anonymous\" integrity=\"sha384-rIRjIHrr5XnyB1DG8t+uL1F3e5asM+gYMial0fj56hCWADEBdp3BiwtOAnNpU7Zc\" type=\"text/javascript\"></script></div>\n<!-- close #container -->\n</body>\n</html>\n";
        const string CorrectPostbackContent = "<form action=\"https://test.okta.com/\"";
        const int MaxRetryCount = 15;
        const int MaxRetryTimeout = 400;

        [Test]
        public void TestSsoTokenUrlMismatch()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://snowflakecomputing.okta1.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://snowflakecomputing.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("account=test;user=test;password=test;authenticator=https://snowflake.okta.com", new SessionPropertiesContext(), restRequester);
                sfSession.Open();
                Assert.Fail("Should not pass");
            }
            catch (SnowflakeDbException e)
            {
                Assert.AreEqual(SFError.IDP_SSO_TOKEN_URL_MISMATCH.GetAttribute<SFErrorAttr>().errorCode, e.ErrorCode);
            }
        }

        [Test]
        public void TestMissingPostbackUrl()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://snowflakecomputing.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://snowflakecomputing.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = NoPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("account=test;user=test;password=test;authenticator=https://snowflakecomputing.okta.com;" +
                    $"host=test;MAXHTTPRETRIES={MaxRetryCount};RETRY_TIMEOUT={MaxRetryTimeout};", new SessionPropertiesContext(), restRequester);
                sfSession.Open();
                Assert.Fail("Should not pass");
            }
            catch (SnowflakeDbException e)
            {
                Assert.AreEqual(SFError.IDP_SAML_POSTBACK_NOTFOUND.GetAttribute<SFErrorAttr>().errorCode, ((SnowflakeDbException)e.InnerException).ErrorCode);
            }
        }

        [Test]
        public void TestWrongPostbackUrl()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://snowflakecomputing.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://snowflakecomputing.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = WrongPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("account=test;user=test;password=test;authenticator=https://snowflakecomputing.okta.com;host=test", new SessionPropertiesContext(), restRequester);
                sfSession.Open();
                Assert.Fail("Should not pass");
            }
            catch (SnowflakeDbException e)
            {
                Assert.AreEqual(SFError.IDP_SAML_POSTBACK_INVALID.GetAttribute<SFErrorAttr>().errorCode, e.ErrorCode);
            }
        }

        [Test]
        public void TestCorrectPostbackUrl()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://test.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://test.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = CorrectPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("account=test;user=test;password=test;authenticator=https://test.okta.com;host=test.okta.com", new SessionPropertiesContext(), restRequester);
                sfSession.Open();
            }
            catch (SnowflakeDbException e)
            {
                Assert.Fail("Should pass without exception", e);
            }
        }

        [Test]
        public void TestCorrectPostbackUrlAsync()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://test.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://test.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = CorrectPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("account=test;user=test;password=test;authenticator=https://test.okta.com;host=test.okta.com", new SessionPropertiesContext(), restRequester);
                Task connectTask = sfSession.OpenAsync(CancellationToken.None);
                connectTask.Wait();
            }
            catch (SnowflakeDbException e)
            {
                Assert.Fail("Should pass without exception", e);
            }
        }

        [Test]
        public void TestDoesNotThrowErrorForWrongPostbackUrlWhenCheckIsDisabled()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://snowflakecomputing.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://snowflakecomputing.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = WrongPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("disable_saml_url_check=true;account=test;user=test;password=test;authenticator=https://snowflakecomputing.okta.com;host=test", new SessionPropertiesContext(), restRequester);
                sfSession.Open();
            }
            catch (SnowflakeDbException e)
            {
                Assert.Fail("Should pass without exception", e);
            }
        }

        [Test]
        public void TestDoesNotThrowErrorForWrongPostbackUrlWhenCheckIsDisabledAsync()
        {
            try
            {
                var restRequester = new Mock.MockOktaRestRequester()
                {
                    TokenUrl = "https://snowflakecomputing.okta.com/api/v1/sessions?additionalFields=cookieToken",
                    SSOUrl = "https://snowflakecomputing.okta.com/app/snowflake_testaccountdev_1/blah/sso/saml",
                    ResponseContent = WrongPostbackContent,
                    MaxRetryCount = MaxRetryCount,
                    MaxRetryTimeout = MaxRetryTimeout
                };
                var sfSession = new SFSession("disable_saml_url_check=true;account=test;user=test;password=test;authenticator=https://snowflakecomputing.okta.com;host=test", new SessionPropertiesContext(), restRequester);
                Task connectTask = sfSession.OpenAsync(CancellationToken.None);
                connectTask.Wait();
            }
            catch (SnowflakeDbException e)
            {
                Assert.Fail("Should pass without exception", e);
            }
        }

        [Test]
        public void TestLoginRequestToString()
        {
            // Arrange
            string expectedOktaAccount = "mockOktaAccount";
            string expectedOktaUser = "mockOktaUser";
            string expectedOktaUrl = "mockOktaUrl";

            LoginRequestClientEnv loginRequestClientEnv = new LoginRequestClientEnv();

            // Act
            LoginRequest loginRequest = new LoginRequest()
            {
                data = new LoginRequestData()
                {
                    loginName = expectedOktaUser,
                    accountName = expectedOktaAccount,
                    clientAppVersion = SFEnvironment.DriverVersion,
                    clientEnv = loginRequestClientEnv,
                    Authenticator = expectedOktaUrl,
                }
            };

            // Assert
            Assert.AreEqual($"LoginRequest {{data: LoginRequestData {{ClientAppVersion: {SFEnvironment.DriverVersion},\n " +
                $"AccountName: {expectedOktaAccount},\n " +
                $"loginName: {expectedOktaUser},\n " +
                $"ClientEnv: {{ " +
                $"APPLICATION: , " +
                $"OS_VERSION: , " +
                $"NET_RUNTIME: , " +
                $"NET_VERSION: , " +
                $"CERT_REVOCATION_CHECK_MODE:  }},\n " +
                $"authenticator: {expectedOktaUrl} }} }}",
                loginRequest.ToString());
        }

        [Test]
        public void TestAuthenticatorRequestToString()
        {
            // Arrange
            string expectedOktaAccount = "mockOktaAccount";

            // Act
            AuthenticatorRequest authenticatorRequest = new AuthenticatorRequest()
            {
                Data = new AuthenticatorRequestData()
                {
                    AccountName = expectedOktaAccount,
                }
            };

            // Assert
            Assert.AreEqual($"AuthenticatorRequest {{data: AuthenticatorRequestData {{ACCOUNT_NAME: {expectedOktaAccount} }} }}",
                authenticatorRequest.ToString());
        }
    }
}
